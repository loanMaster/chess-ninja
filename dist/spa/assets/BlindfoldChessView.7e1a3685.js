import{d as Y,r as O,C as z,am as o,a as u,aA as G,B as I,o as p,e as f,f as n,g as s,w as h,i as R,Q as v,F as W,ap as H,t as l,h as r,j as g,ao as k,av as S}from"./index.31c42902.js";import{_ as L}from"./ExerciseHeader.a2f395c9.js";import{_ as U}from"./PieceList.5cd26e93.js";import{_ as X}from"./ExerciseBoard.3c828d9e.js";import{_ as M,a as Z,b as ee}from"./ToggleChessPieceNotation.c867de6a.js";import{u as C}from"./exercise.store.a14accfe.js";import{C as V}from"./chess-utils.84608043.js";import"./chess-board.interface.1286316e.js";import"./dateTimestampProvider.aca62768.js";const te={class:"column flex-1"},se={class:"row flex-1",style:{"max-height":"100%",overflow:"hidden"}},ae={class:"col-lg-2 col-md-3 q-pb-sm sm-hide xs-hide",style:{"max-height":"100%","overflow-y":"hidden"}},oe={class:"col-lg-7 col-md-6 col-sm-12 col-xs-12 column justify-start align-start relative-position",style:{"max-height":"100%","max-width":"100%"}},ne={key:0,class:"text-center"},ie={class:"text-h5"},le={class:"row text-h5 q-my-md-xl q-my-sm-md q-my-xs-md justify-center q-gutter-md"},re={class:"column q-gutter-sm q-px-md"},ce={class:"q-mb-md-sm"},ue={class:"column q-gutter-sm q-px-md"},he={class:"q-mb-md-sm"},me={class:"text-h6 q-mb-lg"},de={key:1,class:"column full-height"},pe={class:"md-hide lg-hide xl-hide text-center y-mt-lg"},fe={class:"absolute-full no-pointer-events column justify-center items-center q-mx-auto",style:{"aspect-ratio":"1","max-height":"100%","max-width":"100%"}},ve={key:0,class:"text-h4 bg-secondary q-pa-md non-selectable",style:{opacity:"0.7"}},ge={class:"text-center"},_e={key:0},ke={class:"col-3 q-pt-lg items-center column justify-center xs-hide sm-hide q-gutter-sm"},Oe=Y({__name:"BlindfoldChessView",setup(ye){const _=O(!1),c=O(!1),E=H();z(()=>{C().$patch(e=>{e.board={...e.board,orientation:"white",pieces:{},highlightPositive:[],highlightNegative:[]}}),o().$subscribe(()=>{N.value&&(c.value=!0,y.value&&j.value!==m.value&&C().updateRating({nameOfTheGame:w.value,value:1})),C().$patch(e=>{e.board.pieces=Q(o().position.pieces)})}),q()});function $(){return c.value=!0,o().$patch({gameOngoing:!1})}const F=u(()=>x(o().position.pieces,"white")),K=u(()=>x(o().position.pieces,"black"));function x(e,i){const a={};return Object.keys(o().position.pieces).forEach(t=>{(e[t].toUpperCase()===e[t]&&i==="white"||e[t].toUpperCase()!==e[t]&&i==="black")&&(a[t]=e[t])}),a}const N=u(()=>o().position.isFinished||Object.keys(o().position.pieces).length<3),y=u(()=>o().position.check),j=u(()=>o().position.turn),w=u(()=>E.params.game);async function q(){await o().setupBoard({playerColor:m.value,config:{turn:m.value,pieces:P()}}),o().start(),o().$patch({engineLevel:3}),c.value=!1,_.value=!1,o().$patch({gameOngoing:!0})}function P(){switch(w.value){case"queen-vs-rook":return{E7:"k",F7:"r",A3:"K",C1:"Q"};case"rook-vs-king":return b(["k","K","R"]);case"queen-vs-knights":return J();case"queen-vs-king":default:return b(["k","K","q"])}}function J(){const e=new G;let i=!1,a=!1,t={};do{t=b(["k","K","q","N"]);const d=Object.keys(t).find(D=>t[D]==="N");e.createNew({turn:"white",pieces:t});const B=e.moves(d),A=B[Math.floor(Math.random()*B.length)];t[A.to]="N",e.createNew({turn:"white",pieces:t}),i=e.exportJson().check,e.createNew({turn:"black",pieces:t}),a=e.exportJson().check}while(i||a||Object.keys(e.exportJson().pieces).length<4);return e.terminate(),t}function b(e){const i=new G;let a=V.getRandomSquares(e.length),t={};do{a=V.getRandomSquares(e.length),t={};for(let d=0;d<a.length;d++)t[a[d]]=e[d];i.createNew({turn:m.value==="white"?"black":"white",pieces:t})}while(i.exportJson().check);return i.terminate(),t}const m=u(()=>{switch(w.value){case"queen-vs-king":case"queen-vs-knights":return"black";default:return"white"}});function Q(e){const i={};return Object.keys(e).forEach(a=>{const t=e[a]===e[a].toUpperCase()?"w":"b";i[a.toLowerCase()]=t+e[a].toUpperCase()}),i}async function T(){_.value=!0}return I(()=>{o().stopGame()}),(e,i)=>(p(),f(W,null,[n(L,{class:"self-stretch"}),s("div",te,[s("div",se,[s("div",ae,[n(R,{class:"q-pt-sm q-ma-sm",style:{height:"100%"}},{default:h(()=>[n(Z)]),_:1})]),s("div",oe,[n(R,{class:"q-mx-sm q-mt-sm q-pt-md-lg q-pt-sm-sm",style:{height:"100%"}},{default:h(()=>[_.value?k("",!0):(p(),f("div",ne,[s("div",ie,l(e.$t("Checkmate the opponent's king")),1),s("div",le,[s("div",re,[s("div",ce,l(e.$t("White pieces")),1),n(U,{pieces:r(F)},null,8,["pieces"])]),s("div",ue,[s("div",he,l(e.$t("Black pieces")),1),n(U,{pieces:r(K)},null,8,["pieces"])])]),s("div",me,l(e.$t("You play as"))+" "+l(e.$t(r(m))),1),s("div",null,[n(v,{color:"primary",onClick:T},{default:h(()=>[g(l(e.$t("Click here when you are ready")),1)]),_:1})])])),_.value?(p(),f("div",de,[s("div",{class:"flex-1",style:S([{"overflow-y":"auto"},{opacity:c.value?0:1}])},[n(ee)],4),s("div",pe,[n(v,{color:"primary",onClick:q},{default:h(()=>[g(l(e.$t("Restart")),1)]),_:1}),n(v,{color:"primary",onClick:$,disable:c.value},{default:h(()=>[g(l(e.$t("Give up")),1)]),_:1},8,["disable"]),n(M)])])):k("",!0),s("div",{class:"absolute-full",style:S([{opacity:c.value?1:0},{"pointer-events":"none"}])},[n(X)],4),s("div",fe,[r(N)?(p(),f("div",ve,[s("div",ge,l(e.$t(r(y)?"Checkmate":"Draw")),1),r(y)?(p(),f("div",_e,l(r(j)!==r(m)?e.$t("You won!"):e.$t("You lost")),1)):k("",!0)])):k("",!0)])]),_:1})]),s("div",ke,[n(v,{color:"primary",onClick:q},{default:h(()=>[g(l(e.$t("Restart")),1)]),_:1}),n(v,{color:"primary",onClick:$,disable:c.value},{default:h(()=>[g(l(e.$t("Give up")),1)]),_:1},8,["disable"]),n(M)])])])],64))}});export{Oe as default};
