import{d as D,r as d,b0 as N,C as E,a as C,o as v,e as m,h as g,g as n,t as p,f,F as Q,l as P,ai as V,ay as b,ar as R,w as j,j as A,Q as L}from"./index.acb1a3f4.js";import{_ as M}from"./PieceList.a141debc.js";import{c as F,e as x,_ as U}from"./register-defaults.4e197f54.js";import{C as s}from"./chess-utils.5eb9ca53.js";import{u}from"./exercise.store.a03c0b34.js";import"./chess-board.interface.005362a6.js";import"./dateTimestampProvider.aca62768.js";const W={key:0,class:"flex-1 justify-center column items-center"},z={class:"text-h5 text-center"},K={class:"g-large-font g-full-width q-mt-md"},T={class:"row q-gutter-md max-width-xs q-mt-md justify-center"},G={class:"flex-1",style:{"max-height":"100%"}},H={class:"column items-center"},se=D({__name:"AttackWithBishopView",setup(I){const{revealed:r,store:y,inputDisabled:l}=F(),h=d(!1),k=R(),o=d(""),c=d(""),_=d("w");N(()=>{x.createExercise(10)}),E(async()=>{l.value=!0,u().beginExercise(),w()});async function w(){if(!await x.prepareNewQuestion({inputDisabled:l,revealed:r,router:k}))return;o.value=s.getOtherRandomSquare([o.value]);const e=s.getColor(o.value),i=s.getSquaresOnSameDiagonal(o.value);do c.value=s.getOtherRandomSquare([o.value]);while(i.indexOf(c.value)>-1||s.getColor(c.value)!==e);u().$patch(a=>{a.board={...a.board,orientation:"white",pieces:{[c.value.toLowerCase()]:`${_.value}K`,[o.value.toLowerCase()]:`${_.value==="w"?"b":"w"}B`},highlightPositive:[],highlightNegative:[]}}),l.value=!1}const S=C(()=>u().board.pieces);function O(e,i){if(l.value)return;i.stopPropagation(),h.value=s.areOnSameDiagonal(e,c.value);const a=s.getSquaresOnSameDiagonal(c.value).filter(t=>s.getSquaresOnSameDiagonal(o.value).indexOf(t)>-1);h.value?(l.value=!0,y.$patch(t=>t.exercise.correctAnswers++),u().$patch(t=>{t.board.highlightPositive=[e],t.board.highlightNegative=[]})):(x.handleMistake($,void 0),u().$patch(t=>{t.board.highlightPositive=a,t.board.highlightNegative=[e]})),r.value=!0}function $(){r.value=!0,l.value=!0}function q(e){r.value&&(e.stopPropagation(),w())}const B=C(()=>{if(o.value){const e=s.getSquaresOnSameDiagonal(o.value);do{const i=s.getRandomSquare();e.indexOf(i)===-1&&e.push(i)}while(e.length<12);return e.sort((i,a)=>i>a?1:-1),e}else return[]});return(e,i)=>(v(),m("div",{class:"relative-position column flex-1 self-stretch",onClick:q,ref:"coreExercise"},[g(r)?V("",!0):(v(),m("div",W,[n("div",z,p(e.$t("Attack the king with your bishop")),1),n("div",K,[f(M,{pieces:g(S)},null,8,["pieces"])]),n("div",T,[(v(!0),m(Q,null,P(g(B),a=>(v(),m("div",{key:a,class:"text-h5"},[f(L,{push:"",color:"primary",onClick:t=>O(a,t),"no-caps":""},{default:j(()=>[A(p(a),1)]),_:2},1032,["onClick"])]))),128))])])),n("div",{style:b({opacity:g(r)?1:0}),class:"no-pointer-events absolute-full column items-stretch q-pa-lg"},[n("div",{class:"text-h5 text-center",style:b({color:h.value?"green":"red"})},p(h.value?e.$t("Correct"):e.$t("Wrong")),5),n("div",G,[f(U)]),n("div",H,[n("span",null,p(e.$t("Click to continue")),1)])],4)],512))}});export{se as default};
