import{d as Y,r as N,C as z,am as o,a as u,aA as R,B as I,o as f,e as p,f as n,g as s,w as m,i as S,Q as v,F as W,ap as H,t as l,h as c,j as g,ao as k,av as U}from"./index.e96d80f9.js";import{_ as L}from"./ExerciseHeader.5e43304a.js";import{_ as M}from"./PieceList.fff01c00.js";import{_ as X}from"./ExerciseBoard.d9bf8a36.js";import{_ as Q,a as Z,b as ee}from"./ToggleChessPieceNotation.12647d25.js";import{u as C}from"./exercise.store.ebab5492.js";import{C as V}from"./chess-utils.300d2ee2.js";import"./chess-board.interface.2b616ffc.js";import"./dateTimestampProvider.aca62768.js";const te={class:"column flex-1"},se={class:"row flex-1",style:{"max-height":"100%",overflow:"hidden"}},ae={class:"col-lg-2 col-md-3 q-pb-sm sm-hide xs-hide",style:{"max-height":"100%","overflow-y":"hidden"}},oe={class:"col-lg-7 col-md-6 col-sm-12 col-xs-12 column justify-start align-start relative-position",style:{"max-height":"100%","max-width":"100%"}},ne={key:0,class:"text-center"},ie={class:"text-h5"},le={class:"row text-h5 q-my-md-xl q-my-sm-md q-my-xs-md justify-center q-gutter-md"},re={class:"column q-gutter-sm q-px-md"},ce={class:"q-mb-md-sm"},ue={class:"column q-gutter-sm q-px-md"},me={class:"q-mb-md-sm"},he={class:"text-h6 q-mb-lg"},de={key:1,class:"column full-height"},fe={class:"md-hide lg-hide xl-hide text-center y-mt-lg"},pe={class:"absolute-full no-pointer-events column justify-center items-center q-mx-auto",style:{"aspect-ratio":"1","max-height":"100%","max-width":"100%"}},ve={key:0,class:"text-h4 bg-secondary q-pa-md non-selectable",style:{opacity:"0.7"}},ge={class:"text-center"},_e={key:0},ye={class:"col-3 q-pt-lg items-center column justify-center xs-hide sm-hide q-gutter-sm"},Ge=Y({__name:"BlindfoldChessView",setup(ke){const _=N(!1),r=N(!1),E=H();z(()=>{C().$patch(e=>{e.board={...e.board,orientation:"white",pieces:{},highlightPositive:[],highlightNegative:[]}}),o().$subscribe(()=>{x.value&&(r.value=!0,w.value&&j.value!==h.value&&C().updateRating({nameOfTheGame:B.value,value:1})),C().$patch(e=>{e.board.pieces=T(o().position.pieces)})}),y()});function q(){return r.value=!0,o().$patch({gameOngoing:!1})}const F=u(()=>$(o().position.pieces,"white")),K=u(()=>$(o().position.pieces,"black"));function $(e,i){const a={};return Object.keys(o().position.pieces).forEach(t=>{(e[t].toUpperCase()===e[t]&&i==="white"||e[t].toUpperCase()!==e[t]&&i==="black")&&(a[t]=e[t])}),a}const x=u(()=>o().position.isFinished||Object.keys(o().position.pieces).length<3),w=u(()=>o().position.check),j=u(()=>o().position.turn),B=u(()=>E.params.game);async function y(){await o().setupBoard({playerColor:h.value,config:{turn:h.value,pieces:P()}}),o().start(),o().$patch({engineLevel:3}),r.value=!1,_.value=!1,o().$patch({gameOngoing:!0})}function P(){switch(B.value){case"queen-vs-rook":return{E7:"k",F7:"r",A3:"K",C1:"Q"};case"rook-vs-king":return b(["k","K","R"]);case"queen-vs-knights":return J();case"queen-vs-king":default:return b(["k","K","Q"])}}function J(){const e=new R;let i=!1,a=!1,t={};do{t=b(["k","K","Q","n"]);const d=Object.keys(t).find(D=>t[D]==="n");e.createNew({turn:"black",pieces:t});const O=e.moves(d),G=O[Math.floor(Math.random()*O.length)];!G||(t[G.to]="n",e.createNew({turn:"white",pieces:t}),i=e.exportJson().check,e.createNew({turn:"black",pieces:t}),a=e.exportJson().check)}while(i||a||Object.keys(e.exportJson().pieces).length<5);return e.terminate(),t}function b(e){const i=new R;let a=V.getRandomSquares(e.length),t={};do{a=V.getRandomSquares(e.length),t={};for(let d=0;d<a.length;d++)t[a[d]]=e[d];i.createNew({turn:h.value==="white"?"black":"white",pieces:t})}while(i.exportJson().check);return i.terminate(),t}const h=u(()=>"white");function T(e){const i={};return Object.keys(e).forEach(a=>{const t=e[a]===e[a].toUpperCase()?"w":"b";i[a.toLowerCase()]=t+e[a].toUpperCase()}),i}async function A(){_.value=!0}return I(()=>{o().stopGame()}),(e,i)=>(f(),p(W,null,[n(L,{class:"self-stretch"}),s("div",te,[s("div",se,[s("div",ae,[n(S,{class:"q-pt-sm q-ma-sm",style:{height:"100%"}},{default:m(()=>[n(Z)]),_:1})]),s("div",oe,[n(S,{class:"q-mx-sm q-mt-sm q-pt-md-lg q-pt-sm-sm",style:{height:"100%",overflow:"auto"}},{default:m(()=>[_.value?k("",!0):(f(),p("div",ne,[s("div",ie,l(e.$t("Checkmate the opponent's king")),1),s("div",le,[s("div",re,[s("div",ce,l(e.$t("White pieces")),1),n(M,{pieces:c(F)},null,8,["pieces"])]),s("div",ue,[s("div",me,l(e.$t("Black pieces")),1),n(M,{pieces:c(K)},null,8,["pieces"])])]),s("div",he,l(e.$t("You play as"))+" "+l(e.$t(c(h))),1),s("div",null,[n(v,{color:"primary",onClick:A},{default:m(()=>[g(l(e.$t("Click here when you are ready")),1)]),_:1})])])),_.value?(f(),p("div",de,[s("div",{class:"flex-1",style:U([{"overflow-y":"auto"},{opacity:r.value?0:1}])},[n(ee)],4),s("div",fe,[n(v,{color:"primary",onClick:y},{default:m(()=>[g(l(e.$t("Restart")),1)]),_:1}),n(v,{color:"primary",onClick:q,disable:r.value},{default:m(()=>[g(l(e.$t("Give up")),1)]),_:1},8,["disable"]),n(Q)])])):k("",!0),s("div",{class:"absolute-full",onClick:y,style:U({opacity:r.value?1:0,"pointer-events":r.value?"all":"none"})},[n(X)],4),s("div",pe,[c(x)?(f(),p("div",ve,[s("div",ge,l(e.$t(c(w)?"Checkmate":"Draw")),1),c(w)?(f(),p("div",_e,l(c(j)!==c(h)?e.$t("You won!"):e.$t("You lost")),1)):k("",!0)])):k("",!0)])]),_:1})]),s("div",ye,[n(v,{color:"primary",onClick:y},{default:m(()=>[g(l(e.$t("Restart")),1)]),_:1}),n(v,{color:"primary",onClick:q,disable:r.value},{default:m(()=>[g(l(e.$t("Give up")),1)]),_:1},8,["disable"]),n(Q)])])])],64))}});export{Ge as default};
